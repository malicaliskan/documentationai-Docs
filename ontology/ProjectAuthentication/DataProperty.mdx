# DataProperty

**MPO Version:** 1.3.0

The definition of a data property within a data object. A data property is not just a storage field—it encapsulates the logic, behavior, and metadata associated with a specific piece of data. Through its settings, a data property can define relationships, context-aware values, session-based defaults, computed formulas, access filters, enums, and more. It serves as a powerful unit of business logic tightly integrated with the data model.

```typescript
interface DataProperty = {
  basicSettings : PropertyBasicSettings;
  indexSettings : PropertyIndexSettings;
  enumSettings : PropertyEnumSettings;
  relationSettings : PropertyRelation;
  sessionSettings : PropertySessionSettings;
  staticJoin : PropertyStaticJoin;
  formulaSettings : PropertyFormulaSettings;
  contextSettings : PropertyContextSettings;
  filterSettings : PropertyFilterSettings;
}
```

| Field            | Description                                                                                                                               |
| ---------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| basicSettings    | Defines the foundational attributes of the data property, such as its name, type, whether it's an array, and its general description.     |
| indexSettings    | Controls how the property is indexed in storage systems to optimize lookup and uniqueness behaviors.                                      |
| enumSettings     | Enumerates the fixed set of values this property can take. Only used when the type is set to Enum.                                        |
| relationSettings | Defines relationship mappings if the property refers to another data object, such as foreign keys or join references.                     |
| sessionSettings  | Specifies how the property's value can be derived from the session context, such as assigning `userId` automatically on record creation.  |
| staticJoin       | Defines static join logic for enriching this property with data from other objects, useful for preloading dictionary or reference values. |
| formulaSettings  | Allows the value of the property to be computed from a formula or script, typically used for derived or read-only fields.                 |
| contextSettings  | Provides settings to dynamically set property values based on API execution context, such as input parameters or route metadata.          |
| filterSettings   | Specifies whether and how the property can be used as a filter parameter in API queries or search operations.                             |

## PropertyBasicSettings

**MPO Version:** 1.3.0

Defines the core structure and behavior of a data property. Beyond basic typing, this section governs how the property participates in data integrity, mutability, API exposure, and logic-driven behaviors such as hashing or auto-increment. Use this section to establish the foundational logic and identity of the property within your data object.

```typescript
interface PropertyBasicSettings = {
  name : String;
  type : DataTypes;
  isArray : Boolean;
  description : Text;
  isRequired : Boolean;
  allowUpdate : Boolean;
  requiredInUpdate : Boolean;
  allowAutoUpdate : Boolean;
  autoIncrement : Boolean;
  hashed : Boolean;
  defaultValues : PropertyDefaults;
}
```

| Field            | Description                                                                                                                                                                                                                                                                 |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| name             | Unique identifier for the property within the data object. This name is used throughout route definitions, generated code, and logic expressions. Use camelCase formatting, avoid spaces and special characters, and ensure the name is unique within the same data object. |
| type             | Defines the property's data type. Use a value from the `DataTypes`. The selected type impacts validation, storage schema, and frontend component inference.                                                                                                                 |
| isArray          | Indicates if the property stores multiple values (array). Supported by databases like PostgreSQL and MongoDB. Default is `false`.                                                                                                                                           |
| description      | Optional textual description of the property's role in the domain. Useful for documentation and as a semantic hint across logic and UI components.                                                                                                                          |
| isRequired       | If `true`, this property must be provided when a new object is created. It is enforced during validation.                                                                                                                                                                   |
| allowUpdate      | Controls whether the property can be modified after creation. If `false`, updates to this field are ignored unless overridden explicitly.                                                                                                                                   |
| requiredInUpdate | If `true`, the property must be present in update operations. Commonly used for fields that must be kept consistent across updates (e.g. version, status).                                                                                                                  |
| allowAutoUpdate  | If `true`, this property will be automatically included in the update parameters for default routes unless custom logic is applied. Helps streamline generic update routes.                                                                                                 |
| autoIncrement    | If `true`, this property will be auto-generated by incrementing the latest existing value. Suitable for numeric IDs or sequences managed internally.                                                                                                                        |
| hashed           | If `true`, the property's value will be hashed before storage. This is irreversible and is typically used for storing passwords or other sensitive values.                                                                                                                  |
| defaultValues    | Defines default values to be used during create or update operations when the property is missing. Values must match the property's `type` and `isArray` setting in JSON format.                                                                                            |

### DataTypes

These are the standardized data types used in microservice data models and BFF data views in Mindbricks.

const DataTypes = {
ID : "ID",
String : "String",
Text : "Text",
Integer : "Integer",
Boolean : "Boolean",
Double : "Double",
Float : "Float",
Short : "Short",
Object : "Object",
Date : "Date",
Enum : "Enum",
GeoPoint : "GeoPoint",
GeoRoute : "GeoRoute",
GeoArea : "GeoArea",
}

````

Enum | Description
------|-------------
  ID | Represents a unique identifier. Implemented as UUID in SQL databases and ObjectID in NoSQL databases.
  String | Represents short text values, typically capped at 255 characters.
  Text | Represents long-form text content suitable for descriptions or rich text.
  Integer | Represents 4-byte integer values used for whole numbers.
  Boolean | Represents logical values true or false.
  Double | Represents 8-byte double-precision floating-point numbers.
  Float | Represents 4-byte single-precision floating-point numbers.
  Short | Represents 2-byte short integers, useful for flags.
  Object | Represents a generic JSON object, useful for flexible data structures.
  Date | Represents date-time values, stored as ISO 8601 strings in UTC timezone.
  Enum | Represents a fixed set of string values. Enum options are defined as an array of strings and internally stored as a short string.
  GeoPoint | Repesents a geography point on the earth. It is a POINT GeoJson object storing lon and lat values.
  GeoRoute | Represents a geography route on the earth. It is a LINESTRING GeoJson object, with an array of lon and lat pairs.
  GeoArea | Represents a geography area on the earth. It is a POLYGON GeoJson object, with an array of lon and lat pairs. It hsould be closed as the last and first points should be equal. If not first point will be added automaticall as last point also.

### PropertyDefaults

**MPO Version:**  1.3.0

Defines fallback values for create and update operations when the property is not explicitly provided. These settings ensure consistency and reduce frontend responsibility in form submission. Values must match the JSON representation of the property's `type` (`DataTypes`) and `isArray` setting. Examples: String→`"text"`, Integer→`123`, Boolean→`true`, Date→`"2024-01-01T00:00:00Z"`, Enum→`"enumValueAsStr"`, Object→`{}`, or wrapped in arrays like `["text1","text2"]` when isArray=true. Note that the Enum type is represented by string value here instead of the Integer index.

```typescript
interface PropertyDefaults = {
  default : AnyComplex;
  defaultInUpdate : AnyComplex;
  alwaysCreateWithDefaultValue : Boolean;
}
````

| Field                        | Description                                                                                                                                                                                                                                                                                                               |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| default                      | Default value applied in create operations if the property is not provided. Commonly used to set initial values like statuses, flags, or timestamps. Set to `null` when no meaningful default exists. Value must match the property's `type` and `isArray` setting in JSON format.                                        |
| defaultInUpdate              | Default value applied in update operations if the property is required in update but not explicitly provided in the request payload. Set to `null` when no meaningful default exists. Value must match the property's `type` and `isArray` setting in JSON format.                                                        |
| alwaysCreateWithDefaultValue | If `true`, the default value will always be used during creation, even if the client provides a value for this property. This is useful for enforcing system-controlled initialization—such as setting fields based on minimal authorization rights—that should only be modified later by users with elevated privileges. |

## PropertyIndexSettings

**MPO Version:** 1.3.0

Index configuration for the data property across supported storage and caching layers. This includes Elasticsearch indexing for query performance, relational database indexing for faster selection, and Redis-based optimizations for efficient cache invalidation and retrieval. Use these settings to control how the property contributes to performance, queryability, and caching logic.

```typescript
interface PropertyIndexSettings = {
  indexedInElastic : Boolean;
  fulltextSearch : Boolean;
  indexedInDb : Boolean;
  unique : Boolean;
  clusterInRedis : Boolean;
  cacheSelect : Boolean;
  isSecondaryKey : Boolean;
}
```

| Field            | Description                                                                                                                                                                                                                                         |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| indexedInElastic | Determines whether the property is indexed in the Elasticsearch CQRS index. When enabled, this property can be used in DataView filters and search queries.                                                                                         |
| fulltextSearch   | If set to true, Mindbricks will create an additional text index in elastic search other than the type based term query. Note that this feature is ignored if indexedInElastic is false. Text type data properties are alread have full text search. |
| indexedInDb      | Specifies whether a native database index should be created for this property to accelerate selection queries. Recommended for frequently filtered or sorted fields.                                                                                |
| unique           | Indicates whether the property's value must be unique across all records. Enabling this will enforce a uniqueness constraint at the database level.                                                                                                 |
| clusterInRedis   | Specifies whether the property should contribute to Redis cluster keys for partial cache invalidation. This improves cache sensitivity but may increase Redis storage.                                                                              |
| cacheSelect      | Defines whether this property is used as a key in Redis entity cache for batch-select operations. Enables lookup by this value across cached entities.                                                                                              |
| isSecondaryKey   | Marks the property as a secondary identifier, improving query performance on non-primary keys. Useful for access tokens, slugs, or alternative keys.                                                                                                |

## PropertyEnumSettings

**MPO Version:** 1.3.0

Enum configuration for the data property, applicable when the property type is set to Enum. While enum values are stored as integers in the database, defining the enum options here allows Mindbricks to enrich API responses with human-readable labels, easing interpretation and UI integration. If not defined, only the numeric value will be returned.

```typescript
interface PropertyEnumSettings = {
  hasEnumOptions : Boolean;
  configuration : PropertyEnumSettingsConfig;
}
```

| Field          | Description                                                                          |
| -------------- | ------------------------------------------------------------------------------------ |
| hasEnumOptions | Enables support for named enum values when the property type is Enum.                |
| configuration  | The configuration object for enum options. Leave it null if hasEnumOptions is false. |

### PropertyEnumSettingsConfig

**MPO Version:** 1.3.0

Configuration settings for enum options in a data property. This object defines the symbolic names that the enum type property can have. These labels are used in generated documentation and API responses.

```typescript
interface PropertyEnumSettingsConfig = {
  enumOptions : String[];
}
```

| Field       | Description                                                                                             |
| ----------- | ------------------------------------------------------------------------------------------------------- |
| enumOptions | An ordered list of enum string values representing the symbolic values that the enum property can have. |

## PropertyRelation

**MPO Version:** 1.3.0

Defines the relationship configuration for the data property. This is used when the property acts as a foreign key referencing another data object. It allows setting up parent-child relationships, cascade behaviors, and enriches both code generation and documentation with relational semantics.

```typescript
interface PropertyRelation = {
  hasRelation : Boolean;
  configuration : PropertyRelationConfig;
}
```

| Field         | Description                                                                                                                                                                    |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| hasRelation   | Indicates whether this property represents a foreign key relationship to another data object. If enabled, additional settings like the target object and key must be provided. |
| configuration | The configuration object for the property relation. Leave it null if hasRelation is false.                                                                                     |

### PropertyRelationConfig

**MPO Version:** 1.3.0

Configuration object for property relations. Defines the details of the foreign key relationship, including the relation name, target object, target key, parent/child semantics, delete behavior, and whether the relation is required. Used only if hasRelation is true.

```typescript
interface PropertyRelationConfig = {
  relationName : String;
  relationTargetObject : DataObjectName;
  relationTargetKey : PropRefer;
  onDeleteAction : RelationOnDeleteAction;
  relationIsRequired : Boolean;
}
```

| Field                | Description                                                                                                                                                            |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| relationName         | A single-word, human-readable name that identifies the relationship. This name is used in generated code and documentation to represent joined data via this relation. |
| relationTargetObject | The name of the data object this property relates to. This defines the target of the foreign key relationship.                                                         |
| relationTargetKey    | The property name (usually 'id') in the target object that this property references. This is the destination key for the relation.                                     |
| onDeleteAction       | Determines what action should be taken if the related (parent) object is deleted. Options include cascading the delete or nullifying this property.                    |
| relationIsRequired   | Defines whether the relation is mandatory. If true, the property must always reference a valid record in the related data object.                                      |

#### RelationOnDeleteAction

Defines the available strategies for handling related records when a referenced (parent) object is deleted.

const RelationOnDeleteAction = {
doDelete : "doDelete",
setNull : "setNull",
}

````

Enum | Description
------|-------------
  doDelete | Automatically delete this object if the referenced target object is deleted. This is a cascading delete.
  setNull | Set this property to null when the referenced object is deleted, effectively removing the relation without deleting this object.

#### PropRefer

**MPO Version:**  1.3.0

Represents a reference to a property of a data object, optionally renaming it in the current context. It is a string data, however can store string pairs joined with ':'.The first part is the name ofthe property and the second part after ':' mark is how it will be renamed in the context. If no second partis provided, the property is named in the context with its original name. Renaming is useful for mapping remote object properties to local aliases or transforming naming for aggregation.

```typescript
interface PropRefer = {
}
````

| Field | Description |
| ----- | ----------- |

## PropertySessionSettings

**MPO Version:** 1.3.0

Defines how this property is populated from the session context. Session-driven properties are commonly used to associate records with the current user or tenant automatically during create/update operations.

```typescript
interface PropertySessionSettings = {
  isSessionData : Boolean;
  configuration : PropertySessionSettingsConfig;
}
```

| Field         | Description                                                                                                                         |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| isSessionData | Indicates whether this property is automatically populated from the session context. If true, additional configuration is required. |
| configuration | The configuration object for session mapping. Leave it null if isSessionData is false.                                              |

### PropertySessionSettingsConfig

**MPO Version:** 1.3.0

Configuration object for session mapping. Defines the mapping between session properties and data object fields. This allows automatic population of data object properties from session data during create/update operations.

```typescript
interface PropertySessionSettingsConfig = {
  sessionParam : String;
  isOwnerField : Boolean;
}
```

| Field        | Description                                                                                                                                                                                                                                                                                                    |
| ------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| sessionParam | Specifies the name of the session field to bind to this property. Defaults to the property name if not explicitly provided. For example, if the session contains `userId`, that can be mapped to this field.                                                                                                   |
| isOwnerField | Marks this property as the ownership field for the data object. When true, the property is used to enforce ownership-based access control (e.g., ensuring users can only modify their own records). This should be used when the property semantically identifies the owner of the record, typically a userId. |

## PropertyStaticJoin

**MPO Version:** 1.3.0

Static join settings define how this property's value is derived from another data object at the time of creation or update. This approach is useful when a field in the current object depends on a static value from a related object, and that value is not expected to change frequently. Unlike dynamic joins, static joins store the fetched value directly to allow for faster queries and avoid repeated lookups. A common use case is transferring tenant or client identifiers from a parent object into a child record. For example, when creating an email job for a specific user, the system can use the userId to join the User object, fetch its clientId, and statically assign it to the EmailJob object. This makes it easy to query email jobs by clientId without needing to join back to the User table at runtime. Note that, all static joins are executed before the property formula executions and the fetched data and read property (field) is written to the context like `this.product` and `this.amount`, so you can use these context data with in the calculated properties for either the same joint property or for another property.

```typescript
interface PropertyStaticJoin = {
  isStaticJoin : Boolean;
  configuration : PropertyStaticJoinConfig;
}
```

| Field         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| isStaticJoin  | Indicates whether this property should be populated from a static join with another data object. Static joins allow you to copy a fixed value from a related object (such as a foreign key reference) into this object at the time of creation or update. This enables fast lookups without needing runtime joins. Often used for propagating static values like tenantId, clientId, or status names. Enable this only when the source data is relatively stable and changes infrequently, as the joined value is stored statically and won't automatically update if the source changes. |
| configuration | The configuration object that defines the static join settings. Leave it null if the property is not a sttaic join.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

### PropertyStaticJoinConfig

**MPO Version:** 1.3.0

Configuration object for static joins. This object contains the settings that define how the static join is established, including the source object, the field to be joined, and the keys used for matching records. It is used in conjunction with the `isStaticJoin` property to enable static joins in data objects.

```typescript
interface PropertyStaticJoinConfig = {
  jointSource : DataObjectName;
  jointRead : PropRefer;
  jointSourceKey : PropRefer;
  jointForeignKey : PropRefer;
}
```

| Field           | Description                                                                                                                                                                                                      |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| jointSource     | The name and optionally the service of the source object from which the value will be joined. If the source is in another service, Mindbricks will automatically use Elasticsearch indexing to perform the join. |
| jointRead       | The name of the property in the source object whose value will be copied into the current property. Defaults to the same name as this property if not specified.                                                 |
| jointSourceKey  | The key in the source object used to identify the matching record. This is typically 'id' as the primary identifier of the source object. This field acts as the join source in the static join relationship.    |
| jointForeignKey | The property in the current object used as a reference to the source object (i.e., the foreign key). For example, if joining user.clientId via userId, the foreign key is 'userId'.                              |

## PropertyFormulaSettings

**MPO Version:** 1.3.0

Specifies formula-based logic for computing the value of a data property. Use this when the property should not be directly provided by the user but instead derived through predefined calculations during create or update operations. Note that formula caluclations are made at the final point of the data clause building, so you can acess other property values that are populated from other sources. The formulas are calculated in create and update api's, so these API's will automatically manage the calculated population of the related properties. If you need more complex calculations in API level, you can use dataClause settings of the API combined with Api actions.

```typescript
interface PropertyFormulaSettings = {
  isCalculated : Boolean;
  configuration : PropertyFormulaSettingsConfig;
}
```

| Field         | Description                                                                                                                                                                          |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| isCalculated  | Indicates whether this property is calculated using an MScript formula. When enabled, the property’s value will be automatically derived instead of supplied directly by the client. |
| configuration | The configuration object for formula-based calculation. Leave it null if isCalculated is false.                                                                                      |

### PropertyFormulaSettingsConfig

**MPO Version:** 1.3.0

Configuration object for formula-based calculation. Defines the primary formula and optional update formula for computed properties. This allows dynamic calculation of values during create or update operations.

```typescript
interface PropertyFormulaSettingsConfig = {
  formula : MScript;
  updateFormula : MScript;
  calculateWhenInputHas : PropRefer[];
  calculateAfterInstance : Boolean;
}
```

| Field                  | Description                                                                                                                                                                                                          |
| ---------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| formula                | The primary MScript formula used to compute the property's value during creation or when no update-specific formula is defined. Use `this.{property}` syntax to access other values in the same request context.     |
| updateFormula          | Optional MScript formula to override the default formula during update operations. If omitted, the main formula will be used for updates as well.                                                                    |
| calculateWhenInputHas  | List of field names that trigger recalculation during updates. If any of these fields appear in the input, the formula will be re-evaluated. This is useful for dependent computations.                              |
| calculateAfterInstance | Indicates whether the formula should be executed after the full instance is created or loaded. This is necessary when the formula depends on values not present in the input but available only after instantiation. |

## PropertyContextSettings

**MPO Version:** 1.3.0

Defines how this property is automatically populated from the request-time execution context. This is useful when the property value is fetched or computed externally before being written to the database—such as through API fetches, middleware injections, or upstream aggregations.

```typescript
interface PropertyContextSettings = {
  isContextData : Boolean;
  configuration : PropertyContextSettingsConfig;
}
```

| Field         | Description                                                                                                                                                                          |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| isContextData | Indicates whether this property derives its value from the execution context during a request. This enables dynamic assignment of the property using data available only at runtime. |
| configuration | The configuration object for context mapping. Leave it null if isContextData is false.                                                                                               |

### PropertyContextSettingsConfig

**MPO Version:** 1.3.0

Configuration object for context mapping. Defines the mapping between context properties and data object fields. This allows automatic population of data object properties from context data during create/update operations.

```typescript
interface PropertyContextSettingsConfig = {
  contextParam : String;
}
```

| Field        | Description                                                                                                                                                     |
| ------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| contextParam | Specifies the key or path in the context object that holds the value for this property. Supports dot notation for nested context values (e.g., `company.name`). |

## PropertyFilterSettings

**MPO Version:** 1.3.0

Specifies if a data property should be exposed as a query parameter for filtering in auto-generated list endpoints. This allows users to filter records by this field when retrieving data via GET routes. The presence of this configuration determines how the backend interprets and applies client-side query filters.

```typescript
interface PropertyFilterSettings = {
  isFilterParameter : Boolean;
  configuration : PropertyFilterSettingsConfig;
}
```

| Field             | Description                                                                                                                                                                                                                                                               |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| isFilterParameter | Determines whether the property can be used as a query parameter in list (GET) API routes. If enabled, clients can use this property to filter results when calling endpoints like `/customers`. The filtering logic is automatically handled based on the property type. |
| configuration     | The configuration object for filter settings. Leave it null if isFilterParameter is false.                                                                                                                                                                                |

### PropertyFilterSettingsConfig

**MPO Version:** 1.3.0

Configuration object for filter settings. Defines the custom name of the filter parameter in the query string. This is useful when the external API should expose a different term than the internal field name.

```typescript
interface PropertyFilterSettingsConfig = {
  filterName : String;
}
```

| Field      | Description                                                                                                                                                                                 |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| filterName | Custom name of the filter parameter in the query string. Defaults to the property's name. This is useful when the external API should expose a different term than the internal field name. |
