const { HttpServerError, BadRequestError} = 
  require("common");

const {<%= dbObject.modelName %>} = require('models');
const { Op } = require("sequelize");
const { hexaLogger } = require("common");

const get<%= dbObject.modelName %>ListByQuery = async (query) => {
    try {
      if (!query || typeof query !== "object") {
        throw new BadRequestError("Invalid query provided. Query must be an object.");
      }
      <% if (dbObject.objectSettings.basicSettings.useSoftDelete) { %>
      const <%= dbObject.objectName %> = await <%= dbObject.modelName %>.findAll({ 
        where: { ...query, isActive: true } 
      });
      <% } else { %>
      const <%= dbObject.objectName %> = await <%= dbObject.modelName %>.findAll({ 
        where: query 
      });
      <% } %>
      //should i add not found error or only return empty array? 
      if (!<%= dbObject.objectName %> || <%= dbObject.objectName %>.length === 0) return [];
      
      return <%= dbObject.objectName %>.map(item => item.getData());
    } catch (err) {
      //**errorLog
      throw new HttpServerError("errMsg_dbErrorWhenRequesting<%= dbObject.modelName %>ListByQuery", err);
    }
};

module.exports =  get<%= dbObject.modelName %>ListByQuery;