const { HttpServerError, BadRequestError } = require("common");

const {<%= dbObject.modelName %>} = require('models');

const get<%= dbObject.modelName %>ByQuery = async (query) => {
  try {
    if (!query || typeof query !== "object") {
      throw new BadRequestError("Invalid query provided. Query must be an object.");
    }
    const <%= dbObject.objectName %> = await <%= dbObject.modelName %>.findOne(query,null, { sort: { createdAt: -1 }});  
    if (!<%= dbObject.objectName %>) return null;
    
    return <%= dbObject.objectName %>.getData();
  } catch (err) {
    //**errorLog
    throw new HttpServerError("errMsg_dbErrorWhenRequesting<%= dbObject.modelName %>ByQuery", err);
  }
};

module.exports = get<%= dbObject.modelName %>ByQuery; 